<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>마이페이지</title>
    <style>
        .error { color: red; font-size: 0.9em; }
        .success { color: green; font-size: 0.9em; }
        .gray { color: gray; font-size: 0.9em; }
    </style>
</head>
<body>
    <h1>마이페이지</h1>

    <a href="/mypage/edit-info"><button type="button">회원 정보 수정</button></a> <br>
    <a href="/mypage/change-password"><button type="button">비밀번호 변경</button></a> <br>
    <br>
    <a id="auth-button"><button type="button">편집자 인증 받기</button></a> <br>
    <span class="gray">과거인증내역: <span id="auth-history"></span></span>

    <script>
        fetch('/fetch/editor-info')
            .then(response => response.json())
            .then(data => {
                const authHistory = document.getElementById('auth-history');
                const authButton = document.getElementById('auth-button');

                if (data.error) {
                    authHistory.textContent = '없음';
                    authHistory.className='error';
                    authButton.href = '/mypage/editor-apply';
                } else {
                    if(data.status === 'approved'){
                        authHistory.textContent = '이미 인증됨';
                        authHistory.textContent += ` (${data.univ} ${data.college} ${data.major})`;
                        authHistory.className='success';
                        authButton.href = '/mypage/editor-approved';
                    }
                    else if(data.status === 'pending') {
                        authHistory.textContent = '승인 대기 중';
                        authHistory.textContent += ` (${data.univ} ${data.college} ${data.major})`;
                        authHistory.className='success';
                        authButton.href = '/mypage/editor-pending';
                    }
                    else if(data.status === 'rejected') {
                        authHistory.textContent = '인증 거절됨';
                        authHistory.textContent += ` (${data.univ} ${data.college} ${data.major})`;
                        authHistory.className='error';
                        authButton.href = '/mypage/editor-apply';
                    }
                }
            })
            .catch(error => console.error('편집자 정보 로드 실패:', error));
    </script>
</body>
</html>